---

# FLOW APP Sá»” THU CHI â€“ ONE PAGE SCROLL (FINAL v1.3)

## TINH THáº¦N CHUNG (CHá»T)

* 1 trang duy nháº¥t, scroll tá»« trÃªn xuá»‘ng
* Thá»© tá»± cá»‘ Ä‘á»‹nh:
  **Header â†’ Chi â†’ Thu â†’ Tá»•ng káº¿t**
* Má»—i section:
  * CÃ³ **ngÃ y riÃªng**
  * Giao diá»‡n & tÃ­nh nÄƒng tÆ°Æ¡ng Ä‘á»“ng (náº¿u cÃ¹ng loáº¡i)
* KhÃ´ng khoÃ¡ cá»©ng dá»¯ liá»‡u
* CÃ³ cáº£nh bÃ¡o khi thao tÃ¡c "nguy hiá»ƒm"
* App dÃ¹ng cÃ¡ nhÃ¢n â†’ Æ°u tiÃªn **nhanh â€“ rÃµ â€“ khÃ´ng vÃ²ng vo**
* Quy Æ°á»›c dáº¥u . lÃ  phÃ¢n cÃ¡ch hÃ ng nghÃ¬n, dáº¥u , lÃ  tháº­p phÃ¢n. Náº¿u Ä‘Ã¡nh sá»‘ tá»›i hÃ ng nghÃ¬n (á»Ÿ má»i textbox) vd: 3000 app pháº£i Ä‘Æ°a ngay dáº¥u . vÃ o thÃ nh 3.000
* cÃ¡i nÃ o user nháº­p sá»‘ thÃ¬ Ä‘Æ°a cÃ´ng thá»©c chá»© ko Ä‘Æ°a tá»•ng cho gas

---

## 1ï¸âƒ£ HEADER (READ-ONLY â€“ LOAD THEO DATA)

**Khi má»Ÿ app, hiá»ƒn thá»‹ ngay:**

> **Chi cuá»‘i**
> `<mo_ta_chi>`
> Thá»© `<thá»©>` ngÃ y `<ngÃ y chi>`
> Tá»•ng `<NghÃ¬n vnd>` = `<sá»‘ tiá»n vnd>`
> **Sá»‘ dÆ° lÃ½ thuyáº¿t:** `<sá»‘ dÆ° LT>`

**Äáº·c Ä‘iá»ƒm**

* Sticky
* KhÃ´ng input
* Sau má»—i:

  * ThÃªm chi
  * ThÃªm thu
  * XÃ¡c nháº­n tá»•ng káº¿t
    â†’ reload láº¡i block nÃ y

---

## 2ï¸âƒ£ SECTION CHI (FLOW CHÃNH â€“ AUTO FOCUS)

### 2.1 Tráº¡ng thÃ¡i khi má»Ÿ app

* App **auto focus** vÃ o:

  > **Ã´ text box nháº­p tiá»n cá»§a Chi**
* Section Chi á»Ÿ vá»‹ trÃ­ Ä‘áº§u tiÃªn sau Header

---

### 2.2 Chi â€“ Chá»n ngÃ y (RIÃŠNG)

**UI**

```
<<   [ Thá»© Hai 30/01/2026 ]   >>
```
dÃ¹ng tÃ­nh nÄƒng má»Ÿ lá»‹ch giá»‘ng nhÆ° trong ios khi nháº¥n chá»n ngÃ y
**Logic**

* Má»—i section cÃ³ ngÃ y riÃªng
* KhÃ´ng áº£nh hÆ°á»Ÿng Thu / Tá»•ng káº¿t
* KhÃ´ng cho chá»n ngÃ y tÆ°Æ¡ng lai
* NÃºt âš™ï¸ (settings) Ä‘á»ƒ expand/collapse cáº¥u hÃ¬nh (xem 2.4.1)

**Implementation Note:**
* Date input overlay (invisible) Ä‘áº·t trÃªn button display Ä‘á»ƒ trigger native picker trÃªn iOS
* Input type="date" cÃ³ `opacity: 0` nhÆ°ng váº«n clickable
* KhÃ´ng dÃ¹ng `display: none` vÃ¬ iOS Safari khÃ´ng thá»ƒ má»Ÿ picker

---

### 2.3 Chi â€“ Nháº­p sá»‘ tiá»n (x1000, stack)

**HÃ nh vi chuáº©n**

* GÃµ `25` â†’ hiá»‡n `Tá»•ng: 25.000` á»Ÿ display bÃªn dÆ°á»›i (khÃ´ng hiá»‡n trong textbox)
* Láº¯ng nghe input type, chá»‰ cho phÃ©p sá»‘
* Nháº¥n `+`
  * Clear textbox
  * Focus láº¡i input
* GÃµ `35`

  ```
  25.000 + 35.000 = 60.000
  ```

#### Sá»­a sá»‘ Ä‘Ã£ nháº­p

* Nháº¥n `25.000`

  * Load `25` vÃ o textbox
  * QuÃ©t khá»‘i
* KhÃ´ng sá»­a â†’ coi nhÆ° xÃ¡c nháº­n
* Sá»­a â†’ cáº­p nháº­t láº¡i phÃ©p tÃ­nh

#### XoÃ¡

* XoÃ¡ tá»«ng sá»‘
* **XoÃ¡ háº¿t**:

  * Reset **toÃ n bá»™ section Chi vá» default**

    * Sá»‘ tiá»n
    * MÃ´ táº£
    * Nguá»“n tiá»n
    * Tráº¡ng thÃ¡i submit

---

#### **Auto-add khi blur**

* Khi user gÃµ sá»‘ vÃ  click ra ngoÃ i textbox (blur):
* **Tá»± Ä‘á»™ng thÃªm sá»‘ vÃ o stack** (khÃ´ng cáº§n nháº¥n +)
* **Ngoáº¡i trá»«** khi Ä‘ang click vÃ o nÃºt `+` hoáº·c `ğŸ—‘ï¸`
* Sá»­ dá»¥ng flags `isAddingFromButton` vÃ  `isDeletingFromButton`

#### **Sá»­a sá»‘ Ä‘Ã£ nháº­p (Edit Mode)**

**VÃ o Edit Mode:**
* Click vÃ o sá»‘ trong cÃ´ng thá»©c (vd: click vÃ o `25.000`)
* Sá»‘ Ä‘Æ°á»£c **highlight** (class `.editing`)
* Load `25` vÃ o textbox
* NÃºt `+` Ä‘á»•i thÃ nh `âœ“` (confirm button, mÃ u xanh)
* NÃºt `â†»` Ä‘á»•i thÃ nh `ğŸ—‘ï¸` (delete button, mÃ u Ä‘á»)
* **Auto focus** vÃ o textbox

**Real-time update:**
* Khi gÃµ sá»‘ má»›i, cÃ´ng thá»©c cáº­p nháº­t **ngay láº­p tá»©c**
* Sau xÃ¡c nháº­n (nháº¥n âœ“ hoáº·c blur):
  * Textbox reset
  * NÃºt Ä‘á»•i láº¡i `+` vÃ  `â†»`
  * Exit edit mode

#### **XoÃ¡ sá»‘**

**1. Input Mode (nÃºt `â†»`):**
* Nháº¥n `â†»` â†’ confirm dialog â†’ Reset toÃ n bá»™ section Chi

**2. Edit Mode (nÃºt `ğŸ—‘ï¸`):**
* Nháº¥n `ğŸ—‘ï¸` â†’ xÃ³a ngay sá»‘ Ä‘ang edit (khÃ´ng confirm)

---

### 2.4 Chi â€“ MÃ´ táº£ chi

**UI máº·c Ä‘á»‹nh (collapsed):**
* 8 quick chips (load tá»« LocalStorage `quickChipsChi`)
* Chá»‰ chá»n **1**
* Dropdown "MÃ´ táº£ khÃ¡c" (load tá»« `loai_chi`, filter `active=true`)

**Chá»n mÃ´ táº£:**
* Click chip â†’ deselect cÃ¡c chip khÃ¡c, lÆ°u vÃ o `chiDesc`
* Chá»n dropdown â†’ deselect táº¥t cáº£ chips, lÆ°u vÃ o `chiDesc`

---

### 2.4.1 Chi â€“ Settings Panel (Collapsible)

**Trigger:**
* Click nÃºt âš™ï¸ bÃªn cáº¡nh date picker
* Expand/collapse settings panel (smooth animation)

**Ná»™i dung panel:**

**Logic:**
* Load táº¥t cáº£ mÃ´ táº£ tá»« `loai_chi` (active=true)
* Hiá»ƒn thá»‹ checkbox, máº·c Ä‘á»‹nh check 8 mÃ´ táº£ hiá»‡n táº¡i (tá»« LocalStorage)
* **Validation:** Chá»‰ cho check tá»‘i Ä‘a 8 items
* Khi check item thá»© 9 â†’ hiá»‡n message: *"Chá»‰ Ä‘Æ°á»£c chá»n tá»‘i Ä‘a 8 mÃ´ táº£"*
* Khi thay Ä‘á»•i selection â†’ Save vÃ o LocalStorage â†’ Re-render quick chips

**Data flow:**








---

#### **B. ThÃªm mÃ´ táº£ má»›i**

**UI:**








**Validation:**
* Enable nÃºt "ThÃªm" khi:
  * TÃªn mÃ´ táº£ khÃ´ng rá»—ng (trim)
  * ÄÃ£ chá»n phÃ¢n loáº¡i

**Khi nháº¥n "ThÃªm":**
1. Gá»­i POST lÃªn GAS:








2. GAS xá»­ lÃ½:

3. Success:
   - Reload `loai_chi` list
   - Auto-select mÃ´ táº£ vá»«a thÃªm vÃ o dropdown
   - Clear form
   - Show toast: "ÄÃ£ thÃªm mÃ´ táº£: ..."
   - **Auto-collapse** settings panel

---

### 2.5 Chi â€“ Nguá»“n tiá»n

* Dropdown list (load tá»« `nguon_tien`, filter `active=true`)
* Chá»‰ chá»n **1 nguá»“n**

**LÆ°u Ã½:**
* KhÃ´ng cÃ³ nÃºt "ThÃªm nguá»“n tiá»n" trong Section CHI
* Náº¿u cáº§n thÃªm â†’ chá»‰nh sá»­a trá»±c tiáº¿p trong Google Sheet

---

### 2.6 Chi â€“ ThÃªm chi tiÃªu (SUBMIT)

**Enable khi:**
* CÃ³ â‰¥1 sá»‘ tiá»n trong stack
* CÃ³ mÃ´ táº£
* CÃ³ nguá»“n tiá»n

**Khi nháº¥n:**
* Gá»­i dá»¯ liá»‡u lÃªn Google Sheet
* ThÃ´ng bÃ¡o thÃ nh cÃ´ng
* Reload Header
* Reset section Chi
* **Auto-collapse** settings panel (náº¿u Ä‘ang má»Ÿ)
* Focus láº¡i Ã´ nháº­p tiá»n

---

### 2.7 Chi â€“ Visual Styling

**Card CHI:**
* Border trÃ¡i: `4px solid var(--red)`
* Border xung quanh: `2px solid rgba(220, 38, 38, 0.3)`
* Class: `.card-chi`

**Settings Panel:**
* Background: `var(--bg-secondary)`
* Border-top: `1px solid var(--border)`
* Max-height animation cho smooth expand/collapse
* Padding: `1rem`

---

## 3ï¸âƒ£ SECTION THU (FLOW TÆ¯Æ I







